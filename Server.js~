var express = require('express');
var schedule = require('node-schedule');
var batch = require('./scripts/batchNotifier.js');
var app = express();
var router = express.Router();
var path = __dirname + '/views/';

router.use(function (req,res,next){
    console.log('/' + req.method);
    next();
});

router.get('/',function(req,res){
    res.sendFile(path + 'index.html');
});

router.get('/send/message', function(req,res){
    res.sendFile(path + 'sender.html');
});

router.get('/send/batch', function(req, res){
    res.sendFile(path + 'batch.html');
});

router.get('/config', function(req, res){
    res.sendFile(path + 'config.html');
});

app.use('/scripts', express.static(__dirname + '/node_modules/bootstrap/dist/'));

app/use('/css', express.static(__dirname + '/views/'));

app.use('/', router);

app.use('*', function(req,res){
    res.sendFile(path + '404.html');
});

app.listen(3005, function(){
    console.log('Sender Currently Online');

    //CRON Schedule
    schedule.scheduleJob('* 30 6 * * *', function(){
        batch.run('alert');
    });

    schedule.scheduleJob('* 30 18 * * *', function(){
        batch.run('night');
    });
});
